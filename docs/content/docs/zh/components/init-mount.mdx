---
title: 动态挂载
description: 使用 init 方法动态挂载聊天组件
---

import { PropsTable, EventsTable } from '@/components/docs/api-table';

# 动态挂载

除了作为 Vue 组件使用外，ADP Chat Component 还支持通过 `init` 方法动态挂载到任意 DOM 容器中，适用于非 Vue 项目或需要动态创建聊天界面的场景。

## 基础用法

### 通过 CDN 引入

```html
<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="https://unpkg.com/adp-chat-component/dist/style.css">
</head>
<body>
  <div id="chat-container"></div>
  
  <script src="https://unpkg.com/adp-chat-component/dist/adp-chat-component.umd.js"></script>
  <script>
    // 初始化聊天组件
    ADPChatComponent.init('#chat-container', {
      theme: 'light',
      logoTitle: 'AI 助手'
    });
  </script>
</body>
</html>
```

### 通过 NPM 引入

```javascript
import ADPChatComponent from 'adp-chat-component'
import 'adp-chat-component/dist/style.css'

// 初始化聊天组件
ADPChatComponent.init('#chat-container', {
  theme: 'light',
  logoTitle: 'AI 助手'
})
```

## init 方法

```typescript
function init(container?: string, config?: ChatConfig): ComponentInstance
```

### 参数

| 参数 | 类型 | 默认值 | 说明 |
| --- | --- | --- | --- |
| container | `string` | `'body'` | 挂载容器的 CSS 选择器 |
| config | `ChatConfig` | - | 配置选项 |

### 返回值

返回 Vue 组件实例，可用于后续操作。

## ChatConfig 配置

<PropsTable data={[
  { name: 'container', type: 'string', default: "'body'", description: '挂载容器选择器' },
  { name: 'canPark', type: 'boolean', default: 'false', description: '是否可停靠模式（显示悬浮按钮）' },
  { name: 'modelType', type: "'full' | 'compact'", default: "'full'", description: '模式类型：full-全屏模式，compact-紧凑模式' },
  { name: 'width', type: 'string | number', default: '400', description: '宽度（仅在 compact 模式生效）' },
  { name: 'height', type: 'string | number', default: '600', description: '高度（仅在 compact 模式生效）' },
  { name: 'theme', type: "'light' | 'dark'", default: "'light'", description: '主题模式' },
  { name: 'logoUrl', type: 'string', default: "''", description: 'Logo 图片 URL' },
  { name: 'logoTitle', type: 'string', default: "''", description: 'Logo 标题文字' },
  { name: 'applications', type: 'Application[]', default: '[]', description: '应用列表' },
  { name: 'currentApplication', type: 'Application', description: '当前选中的应用' },
  { name: 'conversations', type: 'ChatConversation[]', default: '[]', description: '会话列表' },
  { name: 'currentConversation', type: 'ChatConversation', description: '当前选中的会话' },
  { name: 'chatList', type: 'Record[]', default: '[]', description: '聊天消息列表' },
  { name: 'isChatting', type: 'boolean', default: 'false', description: '是否正在聊天中' },
  { name: 'user', type: 'UserInfo', default: '{}', description: '用户信息' },
  { name: 'languageOptions', type: 'LanguageOption[]', default: '中英文', description: '语言选项列表' },
  { name: 'isMobile', type: 'boolean', default: 'false', description: '是否为移动端' },
  { name: 'modelOptions', type: 'any[]', default: '[]', description: '模型选项列表' },
  { name: 'selectModel', type: 'any', description: '当前选中的模型' },
  { name: 'isDeepThinking', type: 'boolean', default: 'true', description: '是否启用深度思考模式' },
  { name: 'maxAppLen', type: 'number', default: '4', description: '最大应用显示数量' },
  { name: 'showFullscreenButton', type: 'boolean', default: 'false', description: '是否显示全屏按钮' },
  { name: 'isFullscreen', type: 'boolean', default: 'false', description: '是否处于全屏状态' },
  { name: 'onFullscreen', type: '(isFullscreen: boolean) => void', description: '全屏状态切换回调' },
  { name: 'open', type: 'boolean', description: '是否展开面板（仅 canPark 模式）' },
  { name: 'onOpenChange', type: '(open: boolean) => void', description: '面板展开状态变化回调' },
  { name: 'showToggleButton', type: 'boolean', default: 'true', description: '是否显示悬浮切换按钮' },
  { name: 'aiWarningText', type: 'string', default: "'内容由AI生成，仅供参考'", description: 'AI 警告文本' },
  { name: 'createConversationText', type: 'string', default: "'新建对话'", description: '新建对话提示文本' },
  { name: 'sideI18n', type: 'object', description: '侧边栏国际化文本' },
  { name: 'chatI18n', type: 'object', description: '聊天国际化文本' },
  { name: 'chatItemI18n', type: 'object', description: 'ChatItem 国际化文本' },
  { name: 'senderI18n', type: 'object', description: 'Sender 国际化文本' },
  { name: 'apiConfig', type: 'ApiConfig', description: 'API 配置（传入则启用 API 模式）' },
  { name: 'autoLoad', type: 'boolean', default: 'true', description: '是否自动加载数据' },
]} />

## 国际化配置

### sideI18n

```typescript
{
  more?: string           // 更多
  collapse?: string       // 收起
  today?: string          // 今天
  recent?: string         // 最近
  switchTheme?: string    // 切换主题
  selectLanguage?: string // 选择语言
  logout?: string         // 退出登录
}
```

### chatI18n

```typescript
{
  loading?: string      // 加载中
  thinking?: string     // 思考中
  checkAll?: string     // 全选
  shareFor?: string     // 分享至
  copyUrl?: string      // 复制链接
  cancelShare?: string  // 取消分享
  sendError?: string    // 发送失败
  networkError?: string // 网络错误
}
```

### chatItemI18n

```typescript
{
  thinking?: string             // 思考中
  deepThinkingFinished?: string // 深度思考完成
  deepThinkingExpand?: string   // 展开深度思考
  copy?: string                 // 复制
  replay?: string               // 重新生成
  share?: string                // 分享
  good?: string                 // 点赞
  bad?: string                  // 点踩
  thxForGood?: string           // 感谢点赞
  thxForBad?: string            // 感谢反馈
  references?: string           // 参考来源
}
```

### senderI18n

```typescript
{
  placeholder?: string       // 输入框占位符
  placeholderMobile?: string // 移动端输入框占位符
  uploadImg?: string         // 上传图片
  startRecord?: string       // 开始录音
  stopRecord?: string        // 停止录音
  answering?: string         // 正在回答
  notSupport?: string        // 不支持
  uploadError?: string       // 上传失败
  recordTooLong?: string     // 录音时间过长
}
```

## API 模式配置

通过 `apiConfig` 配置 API 路径，组件将自动通过 HTTP 请求获取数据：

```javascript
ADPChatComponent.init('#chat-container', {
  apiConfig: {
    applicationListApi: '/api/applications',
    conversationListApi: '/api/conversations',
    conversationDetailApi: '/api/conversation/detail',
    sendMessageApi: '/api/message/send',
    rateApi: '/api/feedback/rate',
    shareApi: '/api/share/create',
    userInfoApi: '/api/user/info',
    uploadApi: '/api/upload/file',
    asrUrlApi: '/api/helper/asr/url'
  },
  autoLoad: true
})
```

### ApiConfig

```typescript
interface ApiConfig {
  applicationListApi?: string   // 应用列表接口
  conversationListApi?: string  // 会话列表接口
  conversationDetailApi?: string // 会话详情接口
  sendMessageApi?: string       // 发送消息接口
  rateApi?: string              // 评分接口
  shareApi?: string             // 分享接口
  userInfoApi?: string          // 用户信息接口
  uploadApi?: string            // 文件上传接口
  asrUrlApi?: string            // ASR 语音识别 URL 接口
}
```

## 模式说明

### 全屏模式 (full)

组件占满整个容器，适用于独立页面：

```javascript
ADPChatComponent.init('#chat-container', {
  modelType: 'full'
})
```

### 紧凑模式 (compact)

组件以固定宽高显示，适用于嵌入到现有页面：

```javascript
ADPChatComponent.init('#chat-container', {
  modelType: 'compact',
  width: 400,
  height: 600
})
```

### 停靠模式 (canPark)

显示悬浮按钮，点击后展开聊天面板：

```javascript
ADPChatComponent.init('#chat-container', {
  canPark: true,
  showToggleButton: true,
  open: false,
  onOpenChange: (open) => {
    console.log('面板状态:', open)
  }
})
```

## 卸载组件

```javascript
// 卸载指定容器的组件
ADPChatComponent.unmount('#chat-container')
```

## 类型定义

### UserInfo

```typescript
interface UserInfo {
  avatarUrl?: string   // 头像 URL
  avatarName?: string  // 头像显示名称
  name?: string        // 用户名
}
```

### LanguageOption

```typescript
interface LanguageOption {
  key: string    // 语言标识，如 'zh-CN'
  value: string  // 显示名称，如 '简体中文'
}
```

### Application

```typescript
interface Application {
  ApplicationId: string
  Name: string
  Avatar: string
  Greeting: string
  OpeningQuestions: string[]
}
```

### ChatConversation

```typescript
interface ChatConversation {
  Id: string
  AccountId: string
  Title: string
  LastActiveAt: number
  CreatedAt: number
  ApplicationId: string
}
```
